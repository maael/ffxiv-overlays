{"version":3,"file":"static/webpack/static/development/pages/t/sparky.js.da30f42eae71fb5970f8.hot-update.js","sources":["webpack:///./components/ActBase.tsx"],"sourcesContent":["import React, { ReactNode } from 'react';\nimport simulator from '../util/simulator';\nimport {CombatantOptions, EncounterOptions} from '../util/types';\n\nexport interface State {\n  Combatant?: Record<string, Partial<Record<CombatantOptions, string>>>;\n  Encounter?: Partial<Record<EncounterOptions, string>>;\n  isActive?: 'true' | 'false';\n}\n\nexport interface Props {\n  children: (state: State) => ReactNode;\n  onOverlayDataUpdate?: (state: State) => void;\n  onBecomeActive?: (newState: State, prevState: State) => void;\n}\n\nexport default class ActBase extends React.Component<Props, State> {\n  state: State = {};\n  unmounted = false;\n  simulator?: NodeJS.Timeout;\n  componentDidMount () {\n    if (typeof window === 'undefined') return;\n    document.addEventListener('onOverlayDataUpdate', this.onOverlayDataUpdate);\n    window.addEventListener('message', (e) => {\n      if (e.data.type === 'onOverlayDataUpdate') {\n        this.onOverlayDataUpdate(e.data);\n      }\n    });\n    if (window.location.search.includes('simulator')) {\n      this.simulator = simulator(1000);\n    }\n  }\n  componentWillUpdate(_newProps, newState) {\n    const {onBecomeActive} = this.props;\n    if (onBecomeActive && this.state.isActive === 'false' && newState === 'true') {\n      onBecomeActive(newState, this.state);\n    }\n  }\n  componentWillUnmount () {\n    if (simulator) clearInterval(this.simulator);\n    this.unmounted = true;\n  }\n  onOverlayDataUpdate = (data: any) => {\n    const {onOverlayDataUpdate} = this.props;\n    if (this.unmounted) return;\n    const detail: State = data.detail;\n    this.setState({...detail});\n    if (onOverlayDataUpdate) onOverlayDataUpdate(detail);\n  }\n  render () {\n    const {children} = this.props;\n    return children(this.state);\n  }\n}"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAcA;;;;;;;;;;;;;;;;;;AACA;AACA;AAAA;AACA;;;AAuBA;AAAA;AAEA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;;;;;;AA7BA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;;;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;;;AACA;AACA;AACA;AACA;;;AAQA;AAAA;AAEA;AACA;;;;AApCA;AACA;;;;;A","sourceRoot":""}